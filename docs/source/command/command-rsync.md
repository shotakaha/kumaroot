# rsync

```bash
rsync [OPTION]... SRC [SRC]... DEST
rsync [OPTION]... SRC [SRC]... [USER@]HOST:DEST
```

## ファイルをアップロードしたい

```bash
rsync -auvz ファイル名1 [ファイル名2]... [ユーザー名@]ホスト名:ディレクトリ名/
```

``-a``, ``--archive``
: アーカイブモード；``-rlptgoD``に相当

``-u``, ``--update``
: 差分同期（相手先のファイルの方が新しければスキップする）

``-v``, ``--verbose``
: メッセージ出力を増やす

``-z``, ``--compress``
: 転送時にデータを圧縮する

## ディレクトリごとをアップロードしたい

```bash
rsync -auvz ディレクトリ名/ [ユーザー名@]ホスト名:ディレクトリ名/
```

```{note}
ディレクトリ名の末尾に``/``をつける／つけないで動作が変わるので、自分の作業内容に合わせて使い分けてください。
```

## アップロード前に確認したい（``--dry-run``）

```bash
rsync -auvzn ディレクトリ名/ [ユーザー名@]ホスト名:ディレクトリ名/
```

``-n``, ``--dry-run``
: 転送される内容を確認する

## 完全に同期したい（``--delete``）

差分同期（``--update``）でサーバーにアップロードした場合、
手元のコンテンツを削除しても、サーバーにデータが残ったままになってしまいます。
手元のコンテンツとサーバーのコンテンツを完全に同期させたい場合は``--delete``オプションを使います。

```bash
rsync -auvz --delete ディレクトリ名/ [ユーザー名@]ホスト名:ディレクトリ名/
```

``--delete``
: delete extraneous files from destination dirs

デフォルトだと、データは転送前に削除（``--delete-before``）されます。
必要であれば転送中に削除（``--delete-during``）、転送後に削除（``--delete-after``）のオプションを使ってください。

## 特定のファイルを除外したい（``--exclude``）

``.DS_Store``など、サーバーにアップロードする必要がないファイルを除外したい場合は``--exclude``もしくは``--exclude-from``オプションを使います。

```bash
rsync -auvz --exclude ".DS_Store" ディレクトリ名/ [ユーザー名@]ホスト名:ディレクトリ名/
rsync -auvz --exclude=".DS_Store" ディレクトリ名/ [ユーザー名@]ホスト名:ディレクトリ名/
rsync -auvz --exclude-from="除外パターンをまとめたファイル名" ディレクトリ名/ [ユーザー名@]ホスト名:ディレクトリ名/
```

``--exclude=PATTERN``
: PATTERNにマッチしたファイルを除外する

``--exclude-from=FILE``
: FILEから除外パターンを読み込む

除外したいファイルの数が少ない場合は``--exclude``オプションで十分ですが、多い場合は除外パターンをまとめたファイルを用意して``--exclude-from``で読み込ませるのがよいです。
